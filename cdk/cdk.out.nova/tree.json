{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.219.0"},"children":{"ChatbotDatabaseStack":{"id":"ChatbotDatabaseStack","path":"ChatbotDatabaseStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.219.0"},"children":{"SessionsTable":{"id":"SessionsTable","path":"ChatbotDatabaseStack/SessionsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotDatabaseStack/SessionsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"sessionId","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"sessionId","keyType":"HASH"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"tableName":"chatbot-sessions","timeToLiveSpecification":{"attributeName":"ttl","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"ChatbotDatabaseStack/SessionsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}}}},"ConversationsTable":{"id":"ConversationsTable","path":"ChatbotDatabaseStack/ConversationsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotDatabaseStack/ConversationsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"sessionId","attributeType":"S"},{"attributeName":"messageId","attributeType":"S"},{"attributeName":"timestamp","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"TimestampIndex","keySchema":[{"attributeName":"sessionId","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"sessionId","keyType":"HASH"},{"attributeName":"messageId","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"tableName":"chatbot-conversations"}}},"ScalingRole":{"id":"ScalingRole","path":"ChatbotDatabaseStack/ConversationsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}}}},"AnalyticsTable":{"id":"AnalyticsTable","path":"ChatbotDatabaseStack/AnalyticsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotDatabaseStack/AnalyticsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"date","attributeType":"S"},{"attributeName":"eventId","attributeType":"S"},{"attributeName":"sessionId","attributeType":"S"},{"attributeName":"timestamp","attributeType":"S"},{"attributeName":"eventType","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"SessionIndex","keySchema":[{"attributeName":"sessionId","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"EventTypeIndex","keySchema":[{"attributeName":"eventType","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"date","keyType":"HASH"},{"attributeName":"eventId","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"tableName":"chatbot-analytics"}}},"ScalingRole":{"id":"ScalingRole","path":"ChatbotDatabaseStack/AnalyticsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}}}},"CDKMetadata":{"id":"CDKMetadata","path":"ChatbotDatabaseStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ChatbotDatabaseStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}},"Condition":{"id":"Condition","path":"ChatbotDatabaseStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.219.0"}}}},"Exports":{"id":"Exports","path":"ChatbotDatabaseStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Fn::GetAtt\":[\"SessionsTable7C302024\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"SessionsTable7C302024\",\"Arn\"]}","path":"ChatbotDatabaseStack/Exports/Output{\"Fn::GetAtt\":[\"SessionsTable7C302024\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Fn::GetAtt\":[\"ConversationsTableCD91EB96\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"ConversationsTableCD91EB96\",\"Arn\"]}","path":"ChatbotDatabaseStack/Exports/Output{\"Fn::GetAtt\":[\"ConversationsTableCD91EB96\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Fn::GetAtt\":[\"AnalyticsTable3F84C304\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"AnalyticsTable3F84C304\",\"Arn\"]}","path":"ChatbotDatabaseStack/Exports/Output{\"Fn::GetAtt\":[\"AnalyticsTable3F84C304\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Ref\":\"SessionsTable7C302024\"}":{"id":"Output{\"Ref\":\"SessionsTable7C302024\"}","path":"ChatbotDatabaseStack/Exports/Output{\"Ref\":\"SessionsTable7C302024\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Ref\":\"ConversationsTableCD91EB96\"}":{"id":"Output{\"Ref\":\"ConversationsTableCD91EB96\"}","path":"ChatbotDatabaseStack/Exports/Output{\"Ref\":\"ConversationsTableCD91EB96\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Ref\":\"AnalyticsTable3F84C304\"}":{"id":"Output{\"Ref\":\"AnalyticsTable3F84C304\"}","path":"ChatbotDatabaseStack/Exports/Output{\"Ref\":\"AnalyticsTable3F84C304\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ChatbotDatabaseStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.219.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ChatbotDatabaseStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.219.0"}}}},"ChatbotStorageStack":{"id":"ChatbotStorageStack","path":"ChatbotStorageStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.219.0"},"children":{"DocumentsBucket":{"id":"DocumentsBucket","path":"ChatbotStorageStack/DocumentsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotStorageStack/DocumentsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":{"Fn::Join":["",["chatbot-documents-",{"Ref":"AWS::AccountId"},"-",{"Ref":"AWS::Region"}]]},"corsConfiguration":{"corsRules":[{"maxAge":3000,"allowedHeaders":["*"],"allowedMethods":["GET","POST","PUT","DELETE"],"allowedOrigins":["*"]}]},"lifecycleConfiguration":{"rules":[{"id":"DeleteOldVersions","noncurrentVersionExpiration":{"noncurrentDays":30},"status":"Enabled"}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}],"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"ChatbotStorageStack/DocumentsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotStorageStack/DocumentsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"DocumentsBucket9EC9DEB9"},"policyDocument":{"Statement":[{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["DocumentsBucket9EC9DEB9","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentsBucket9EC9DEB9","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"ChatbotStorageStack/DocumentsBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.219.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ChatbotStorageStack/DocumentsBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}},"Notifications":{"id":"Notifications","path":"ChatbotStorageStack/DocumentsBucket/Notifications","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Resource":{"id":"Resource","path":"ChatbotStorageStack/DocumentsBucket/Notifications/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}},"AllowBucketNotificationsToChatbotStorageStackDocumentProcessorC79EA543":{"id":"AllowBucketNotificationsToChatbotStorageStackDocumentProcessorC79EA543","path":"ChatbotStorageStack/DocumentsBucket/AllowBucketNotificationsToChatbotStorageStackDocumentProcessorC79EA543","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DocumentProcessor3D49A083","Arn"]},"principal":"s3.amazonaws.com","sourceAccount":{"Ref":"AWS::AccountId"},"sourceArn":{"Fn::GetAtt":["DocumentsBucket9EC9DEB9","Arn"]}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"ChatbotStorageStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.219.0"},"children":{"Staging":{"id":"Staging","path":"ChatbotStorageStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.219.0"}},"Role":{"id":"Role","path":"ChatbotStorageStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}},"Handler":{"id":"Handler","path":"ChatbotStorageStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}},"ProcessedDocumentsBucket":{"id":"ProcessedDocumentsBucket","path":"ChatbotStorageStack/ProcessedDocumentsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotStorageStack/ProcessedDocumentsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":{"Fn::Join":["",["chatbot-processed-docs-",{"Ref":"AWS::AccountId"},"-",{"Ref":"AWS::Region"}]]},"lifecycleConfiguration":{"rules":[{"id":"TransitionToIA","status":"Enabled","transitions":[{"storageClass":"STANDARD_IA","transitionInDays":30},{"storageClass":"GLACIER","transitionInDays":90}]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"ChatbotStorageStack/ProcessedDocumentsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotStorageStack/ProcessedDocumentsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"ProcessedDocumentsBucket0748053A"},"policyDocument":{"Statement":[{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["ProcessedDocumentsBucket0748053A","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ProcessedDocumentsBucket0748053A","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"ChatbotStorageStack/ProcessedDocumentsBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.219.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ChatbotStorageStack/ProcessedDocumentsBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}}}},"DocumentProcessorRole":{"id":"DocumentProcessorRole","path":"ChatbotStorageStack/DocumentProcessorRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportDocumentProcessorRole":{"id":"ImportDocumentProcessorRole","path":"ChatbotStorageStack/DocumentProcessorRole/ImportDocumentProcessorRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"ChatbotStorageStack/DocumentProcessorRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"policies":[{"policyName":"DocumentProcessorPermissions","policyDocument":{"Statement":[{"Action":["s3:DeleteObject","s3:GetObject","s3:ListBucket","s3:PutObject"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentsBucket9EC9DEB9","Arn"]},{"Fn::GetAtt":["ProcessedDocumentsBucket0748053A","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentsBucket9EC9DEB9","Arn"]},"/*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["ProcessedDocumentsBucket0748053A","Arn"]},"/*"]]}]},{"Action":["bedrock:InvokeModel","bedrock:InvokeModelWithResponseStream"],"Effect":"Allow","Resource":["arn:aws:bedrock:*::foundation-model/amazon.titan-embed-text-v1","arn:aws:bedrock:*::foundation-model/amazon.titan-embed-text-v2"]},{"Action":"cloudwatch:PutMetricData","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"}}]}}}}},"DocumentProcessor":{"id":"DocumentProcessor","path":"ChatbotStorageStack/DocumentProcessor","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.219.0","metadata":[]},"children":{"Code":{"id":"Code","path":"ChatbotStorageStack/DocumentProcessor/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.219.0"},"children":{"Stage":{"id":"Stage","path":"ChatbotStorageStack/DocumentProcessor/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.219.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatbotStorageStack/DocumentProcessor/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.219.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatbotStorageStack/DocumentProcessor/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"ff5c749aae928b4c3ef4b47e43b3cfeb8c74bc259613ff85cc052f9bbfef9983.zip"},"description":"Process uploaded documents for RAG search","environment":{"variables":{"DOCUMENTS_BUCKET":{"Ref":"DocumentsBucket9EC9DEB9"},"PROCESSED_BUCKET":{"Ref":"ProcessedDocumentsBucket0748053A"},"BEDROCK_REGION":{"Ref":"AWS::Region"},"EMBEDDING_MODEL":"amazon.titan-embed-text-v1","BEDROCK_INFERENCE_PROFILE_ARN":"","BEDROCK_CROSS_REGION_PROFILE":"","CHUNK_SIZE":"1000","CHUNK_OVERLAP":"200","LOG_LEVEL":"INFO"}},"handler":"handler.lambda_handler","memorySize":1024,"role":{"Fn::GetAtt":["DocumentProcessorRole12EFF6D7","Arn"]},"runtime":"python3.11","timeout":900}}}}},"BucketNotificationsHandler050a0587b7544547bf325f094a3db834":{"id":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834","path":"ChatbotStorageStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Role":{"id":"Role","path":"ChatbotStorageStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"ChatbotStorageStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"ChatbotStorageStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatbotStorageStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotStorageStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"s3:PutBucketNotification","Effect":"Allow","Resource":{"Fn::GetAtt":["DocumentsBucket9EC9DEB9","Arn"]}}],"Version":"2012-10-17"},"policyName":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36","roles":[{"Ref":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC"}]}}}}}}},"Resource":{"id":"Resource","path":"ChatbotStorageStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}},"DocumentUploadRole":{"id":"DocumentUploadRole","path":"ChatbotStorageStack/DocumentUploadRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportDocumentUploadRole":{"id":"ImportDocumentUploadRole","path":"ChatbotStorageStack/DocumentUploadRole/ImportDocumentUploadRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"ChatbotStorageStack/DocumentUploadRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"policies":[{"policyName":"DocumentUploadPermissions","policyDocument":{"Statement":[{"Action":["s3:GetObject","s3:PutObject","s3:PutObjectAcl"],"Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["DocumentsBucket9EC9DEB9","Arn"]},"/uploads/*"]]}},{"Action":["s3:GetObject","s3:PutObject"],"Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["DocumentsBucket9EC9DEB9","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}]}}}}},"DocumentUploadHandler":{"id":"DocumentUploadHandler","path":"ChatbotStorageStack/DocumentUploadHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.219.0","metadata":[]},"children":{"Code":{"id":"Code","path":"ChatbotStorageStack/DocumentUploadHandler/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.219.0"},"children":{"Stage":{"id":"Stage","path":"ChatbotStorageStack/DocumentUploadHandler/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.219.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatbotStorageStack/DocumentUploadHandler/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.219.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatbotStorageStack/DocumentUploadHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"4e60e932cf87b4235dfe9892ea1b61c31f7024db0acbfab7d8e6a9f8c54e6724.zip"},"description":"Handle document upload requests and generate presigned URLs","environment":{"variables":{"DOCUMENTS_BUCKET":{"Ref":"DocumentsBucket9EC9DEB9"},"UPLOAD_PREFIX":"uploads/","MAX_FILE_SIZE":"50000000","ALLOWED_EXTENSIONS":"pdf,txt,docx,md","PRESIGNED_URL_EXPIRY":"3600","LOG_LEVEL":"INFO"}},"handler":"handler.lambda_handler","memorySize":256,"role":{"Fn::GetAtt":["DocumentUploadRole76486D80","Arn"]},"runtime":"python3.11","timeout":30}}}}},"DocumentProcessingRule":{"id":"DocumentProcessingRule","path":"ChatbotStorageStack/DocumentProcessingRule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotStorageStack/DocumentProcessingRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Handle document processing status updates","eventPattern":{"detail-type":["Document Processing Status"],"source":["chatbot.document.processor"]},"state":"ENABLED"}}}}},"DocumentsBucketName":{"id":"DocumentsBucketName","path":"ChatbotStorageStack/DocumentsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"DocumentsBucketArn":{"id":"DocumentsBucketArn","path":"ChatbotStorageStack/DocumentsBucketArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"ProcessedDocumentsBucketName":{"id":"ProcessedDocumentsBucketName","path":"ChatbotStorageStack/ProcessedDocumentsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"DocumentProcessorArn":{"id":"DocumentProcessorArn","path":"ChatbotStorageStack/DocumentProcessorArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"DocumentUploadHandlerArn":{"id":"DocumentUploadHandlerArn","path":"ChatbotStorageStack/DocumentUploadHandlerArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"DocumentUploadUrl":{"id":"DocumentUploadUrl","path":"ChatbotStorageStack/DocumentUploadUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"ChatbotStorageStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ChatbotStorageStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}},"Condition":{"id":"Condition","path":"ChatbotStorageStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.219.0"}}}},"Exports":{"id":"Exports","path":"ChatbotStorageStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Fn::GetAtt\":[\"ProcessedDocumentsBucket0748053A\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"ProcessedDocumentsBucket0748053A\",\"Arn\"]}","path":"ChatbotStorageStack/Exports/Output{\"Fn::GetAtt\":[\"ProcessedDocumentsBucket0748053A\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Ref\":\"ProcessedDocumentsBucket0748053A\"}":{"id":"Output{\"Ref\":\"ProcessedDocumentsBucket0748053A\"}","path":"ChatbotStorageStack/Exports/Output{\"Ref\":\"ProcessedDocumentsBucket0748053A\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Ref\":\"DocumentsBucket9EC9DEB9\"}":{"id":"Output{\"Ref\":\"DocumentsBucket9EC9DEB9\"}","path":"ChatbotStorageStack/Exports/Output{\"Ref\":\"DocumentsBucket9EC9DEB9\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Fn::GetAtt\":[\"DocumentProcessor3D49A083\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"DocumentProcessor3D49A083\",\"Arn\"]}","path":"ChatbotStorageStack/Exports/Output{\"Fn::GetAtt\":[\"DocumentProcessor3D49A083\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Fn::GetAtt\":[\"DocumentUploadHandlerA7645B2A\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"DocumentUploadHandlerA7645B2A\",\"Arn\"]}","path":"ChatbotStorageStack/Exports/Output{\"Fn::GetAtt\":[\"DocumentUploadHandlerA7645B2A\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ChatbotStorageStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.219.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ChatbotStorageStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.219.0"}}}},"ChatbotLambdaStack":{"id":"ChatbotLambdaStack","path":"ChatbotLambdaStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.219.0"},"children":{"ApiSecrets":{"id":"ApiSecrets","path":"ChatbotLambdaStack/ApiSecrets","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotLambdaStack/ApiSecrets/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"API keys and sensitive configuration for chatbot system","generateSecretString":{"excludeCharacters":" %+~`#336130e2-3ab1-416e-bbe3-4690eb464001*()|[]{}:;<>?!'/@\"\\","generateStringKey":"generated_key","passwordLength":32,"secretStringTemplate":"{\"strand_api_key\": \"placeholder\", \"openai_api_key\": \"placeholder\"}"},"name":"chatbot/api-keys"}}}}},"WebSocketHandlerRole":{"id":"WebSocketHandlerRole","path":"ChatbotLambdaStack/WebSocketHandlerRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportWebSocketHandlerRole":{"id":"ImportWebSocketHandlerRole","path":"ChatbotLambdaStack/WebSocketHandlerRole/ImportWebSocketHandlerRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"ChatbotLambdaStack/WebSocketHandlerRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"policies":[{"policyName":"DynamoDBAccess","policyDocument":{"Statement":[{"Action":["dynamodb:DeleteItem","dynamodb:GetItem","dynamodb:PutItem","dynamodb:Query","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttAnalyticsTable3F84C304ArnFD90B42F"},{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttConversationsTableCD91EB96Arn4A2B28C6"},{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttSessionsTable7C302024Arn24FF8012"},{"Fn::Join":["",[{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttAnalyticsTable3F84C304ArnFD90B42F"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttConversationsTableCD91EB96Arn4A2B28C6"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttSessionsTable7C302024Arn24FF8012"},"/index/*"]]}]}],"Version":"2012-10-17"}},{"policyName":"ApiGatewayManagement","policyDocument":{"Statement":[{"Action":"execute-api:ManageConnections","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"}},{"policyName":"BedrockAccess","policyDocument":{"Statement":[{"Action":["bedrock:InvokeModel","bedrock:InvokeModelWithResponseStream"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:aws:bedrock:",{"Ref":"AWS::Region"},"::foundation-model/amazon.titan-embed-text-v1"]]},{"Fn::Join":["",["arn:aws:bedrock:",{"Ref":"AWS::Region"},"::foundation-model/anthropic.claude-3-5-sonnet-20241022-v2:0"]]}]}],"Version":"2012-10-17"}},{"policyName":"SecretsManagerAccess","policyDocument":{"Statement":[{"Action":"secretsmanager:GetSecretValue","Effect":"Allow","Resource":{"Ref":"ApiSecretsED109BDA"}}],"Version":"2012-10-17"}},{"policyName":"LambdaInvoke","policyDocument":{"Statement":[{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":{"Fn::Join":["",["arn:aws:lambda:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":function:*"]]}}],"Version":"2012-10-17"}}]}}}}},"WebSocketHandler":{"id":"WebSocketHandler","path":"ChatbotLambdaStack/WebSocketHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.219.0","metadata":[]},"children":{"Code":{"id":"Code","path":"ChatbotLambdaStack/WebSocketHandler/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.219.0"},"children":{"Stage":{"id":"Stage","path":"ChatbotLambdaStack/WebSocketHandler/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.219.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatbotLambdaStack/WebSocketHandler/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.219.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatbotLambdaStack/WebSocketHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"c6b907c2c6dd088f440ed8cc5d2007748df0a3a26474c930ada1d2225fdfdf77.zip"},"description":"WebSocket handler for chatbot connections and messages","environment":{"variables":{"SESSIONS_TABLE":{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputRefSessionsTable7C3020246E1CCFDD"},"CONVERSATIONS_TABLE":{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputRefConversationsTableCD91EB96EE2E4585"},"ANALYTICS_TABLE":{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputRefAnalyticsTable3F84C30437863EDE"},"SECRETS_ARN":{"Ref":"ApiSecretsED109BDA"},"MCP_SERVER_ARN":{"Fn::GetAtt":["McpServerConstructMcpServer97485EDE","Arn"]},"BEDROCK_REGION":{"Ref":"AWS::Region"},"BEDROCK_INFERENCE_PROFILE_ARN":"","BEDROCK_CROSS_REGION_PROFILE":"us.amazon.nova-pro-v1:0","BEDROCK_CLAUDE_MODEL":"amazon.nova-pro-v1:0","BEDROCK_EMBEDDING_MODEL":"amazon.titan-embed-text-v1","BEDROCK_CIRCUIT_BREAKER_THRESHOLD":"5","BEDROCK_CIRCUIT_BREAKER_TIMEOUT":"30","WEBSOCKET_DOMAIN_NAME":"ynw017q5lc.execute-api.ap-southeast-1.amazonaws.com","LOG_LEVEL":"INFO"}},"handler":"handler_working.lambda_handler","memorySize":256,"role":{"Fn::GetAtt":["WebSocketHandlerRole54BB05CE","Arn"]},"runtime":"python3.11","timeout":30}}}}},"SessionCleanupRole":{"id":"SessionCleanupRole","path":"ChatbotLambdaStack/SessionCleanupRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportSessionCleanupRole":{"id":"ImportSessionCleanupRole","path":"ChatbotLambdaStack/SessionCleanupRole/ImportSessionCleanupRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"ChatbotLambdaStack/SessionCleanupRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"policies":[{"policyName":"DynamoDBAccess","policyDocument":{"Statement":[{"Action":["dynamodb:BatchWriteItem","dynamodb:DeleteItem","dynamodb:Scan"],"Effect":"Allow","Resource":{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttSessionsTable7C302024Arn24FF8012"}}],"Version":"2012-10-17"}},{"policyName":"CloudWatchMetrics","policyDocument":{"Statement":[{"Action":"cloudwatch:PutMetricData","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"}}]}}}}},"SessionCleanup":{"id":"SessionCleanup","path":"ChatbotLambdaStack/SessionCleanup","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.219.0","metadata":[]},"children":{"Code":{"id":"Code","path":"ChatbotLambdaStack/SessionCleanup/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.219.0"},"children":{"Stage":{"id":"Stage","path":"ChatbotLambdaStack/SessionCleanup/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.219.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatbotLambdaStack/SessionCleanup/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.219.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatbotLambdaStack/SessionCleanup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"6b57b9415e565de4dec459ad170bc484f93f4c4fce6e9a4eda6ab5d2f2d65a69.zip"},"description":"Automated cleanup of inactive and expired sessions","environment":{"variables":{"SESSIONS_TABLE":{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputRefSessionsTable7C3020246E1CCFDD"},"SESSION_TIMEOUT_MINUTES":"30","DRY_RUN":"false"}},"handler":"handler.lambda_handler","memorySize":128,"role":{"Fn::GetAtt":["SessionCleanupRoleC8FA8A84","Arn"]},"runtime":"python3.11","timeout":300}}}}},"McpServerConstruct":{"id":"McpServerConstruct","path":"ChatbotLambdaStack/McpServerConstruct","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"McpServerSecrets":{"id":"McpServerSecrets","path":"ChatbotLambdaStack/McpServerConstruct/McpServerSecrets","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotLambdaStack/McpServerConstruct/McpServerSecrets/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Sensitive configuration for MCP server","generateSecretString":{"excludeCharacters":" %+~`#$&*()|[]{}:;<>?!'/@\"\\","generateStringKey":"api_key","passwordLength":32,"secretStringTemplate":"{\"placeholder\": \"value\"}"},"name":"chatbot/mcp-server"}}}}},"McpServerRole":{"id":"McpServerRole","path":"ChatbotLambdaStack/McpServerConstruct/McpServerRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportMcpServerRole":{"id":"ImportMcpServerRole","path":"ChatbotLambdaStack/McpServerConstruct/McpServerRole/ImportMcpServerRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"ChatbotLambdaStack/McpServerConstruct/McpServerRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"policies":[{"policyName":"BedrockAccess","policyDocument":{"Statement":[{"Action":["bedrock:InvokeModel","bedrock:InvokeModelWithResponseStream"],"Effect":"Allow","Resource":["arn:aws:bedrock:*::foundation-model/amazon.titan-embed-text-v1","arn:aws:bedrock:*::foundation-model/anthropic.claude-3-5-sonnet-20241022-v2:0"]}],"Version":"2012-10-17"}},{"policyName":"DynamoDBAccess","policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:DeleteItem","dynamodb:GetItem","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttAnalyticsTable3F84C304ArnFD90B42F"},{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttConversationsTableCD91EB96Arn4A2B28C6"},{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttSessionsTable7C302024Arn24FF8012"},{"Fn::Join":["",[{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttAnalyticsTable3F84C304ArnFD90B42F"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttConversationsTableCD91EB96Arn4A2B28C6"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputFnGetAttSessionsTable7C302024Arn24FF8012"},"/index/*"]]}]}],"Version":"2012-10-17"}},{"policyName":"OpenSearchAccess","policyDocument":{"Statement":[{"Action":["aoss:APIAccessAll","aoss:DashboardsAccessAll"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"}},{"policyName":"SecretsManagerAccess","policyDocument":{"Statement":[{"Action":"secretsmanager:GetSecretValue","Effect":"Allow","Resource":{"Ref":"McpServerConstructMcpServerSecretsD3E08119"}}],"Version":"2012-10-17"}},{"policyName":"S3Access","policyDocument":{"Statement":[{"Action":["s3:GetObject","s3:ListBucket"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"ChatbotStorageStack:ExportsOutputFnGetAttProcessedDocumentsBucket0748053AArnC4CD5E76"},{"Fn::Join":["",[{"Fn::ImportValue":"ChatbotStorageStack:ExportsOutputFnGetAttProcessedDocumentsBucket0748053AArnC4CD5E76"},"/*"]]}]}],"Version":"2012-10-17"}},{"policyName":"CloudWatchMetrics","policyDocument":{"Statement":[{"Action":"cloudwatch:PutMetricData","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"}}]}}}}},"McpServer":{"id":"McpServer","path":"ChatbotLambdaStack/McpServerConstruct/McpServer","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.219.0","metadata":[]},"children":{"Code":{"id":"Code","path":"ChatbotLambdaStack/McpServerConstruct/McpServer/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.219.0"},"children":{"Stage":{"id":"Stage","path":"ChatbotLambdaStack/McpServerConstruct/McpServer/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.219.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatbotLambdaStack/McpServerConstruct/McpServer/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.219.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatbotLambdaStack/McpServerConstruct/McpServer/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"2ce4bc4183b4c0fa4b5b4c9ae1d68ff2042789e3810a90a373a4290d71ec91a0.zip"},"description":"MCP server with RAG and CRUD tools using OpenAPI schema","environment":{"variables":{"SCHEMA_PATH":"/var/task/mcp_tools_schema.yaml","SESSIONS_TABLE":{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputRefSessionsTable7C3020246E1CCFDD"},"CONVERSATIONS_TABLE":{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputRefConversationsTableCD91EB96EE2E4585"},"ANALYTICS_TABLE":{"Fn::ImportValue":"ChatbotDatabaseStack:ExportsOutputRefAnalyticsTable3F84C30437863EDE"},"PROCESSED_BUCKET":{"Fn::ImportValue":"ChatbotStorageStack:ExportsOutputRefProcessedDocumentsBucket0748053A42BFD98D"},"SECRETS_ARN":{"Ref":"McpServerConstructMcpServerSecretsD3E08119"},"BEDROCK_REGION":"ap-southeast-1","BEDROCK_INFERENCE_PROFILE_ARN":"","BEDROCK_CROSS_REGION_PROFILE":"","EMBEDDING_MODEL":"amazon.titan-embed-text-v1","LOG_LEVEL":"INFO"}},"handler":"handler.lambda_handler","memorySize":512,"role":{"Fn::GetAtt":["McpServerConstructMcpServerRole0B174941","Arn"]},"runtime":"python3.11","timeout":300}}}}},"McpServerArn":{"id":"McpServerArn","path":"ChatbotLambdaStack/McpServerConstruct/McpServerArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"McpServerName":{"id":"McpServerName","path":"ChatbotLambdaStack/McpServerConstruct/McpServerName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"McpSecretsArn":{"id":"McpSecretsArn","path":"ChatbotLambdaStack/McpServerConstruct/McpSecretsArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}}}},"SessionCleanupSchedule":{"id":"SessionCleanupSchedule","path":"ChatbotLambdaStack/SessionCleanupSchedule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotLambdaStack/SessionCleanupSchedule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Trigger session cleanup Lambda function every hour","scheduleExpression":"rate(1 hour)","state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["SessionCleanupAC8C796B","Arn"]},"retryPolicy":{"maximumRetryAttempts":2}}]}}},"AllowEventRuleChatbotLambdaStackSessionCleanupE7F5E176":{"id":"AllowEventRuleChatbotLambdaStackSessionCleanupE7F5E176","path":"ChatbotLambdaStack/SessionCleanupSchedule/AllowEventRuleChatbotLambdaStackSessionCleanupE7F5E176","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["SessionCleanupAC8C796B","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["SessionCleanupSchedule59730D2C","Arn"]}}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"ChatbotLambdaStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ChatbotLambdaStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}},"Condition":{"id":"Condition","path":"ChatbotLambdaStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.219.0"}}}},"Exports":{"id":"Exports","path":"ChatbotLambdaStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Fn::GetAtt\":[\"WebSocketHandler47C0AA1A\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"WebSocketHandler47C0AA1A\",\"Arn\"]}","path":"ChatbotLambdaStack/Exports/Output{\"Fn::GetAtt\":[\"WebSocketHandler47C0AA1A\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Fn::GetAtt\":[\"McpServerConstructMcpServer97485EDE\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"McpServerConstructMcpServer97485EDE\",\"Arn\"]}","path":"ChatbotLambdaStack/Exports/Output{\"Fn::GetAtt\":[\"McpServerConstructMcpServer97485EDE\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Fn::GetAtt\":[\"SessionCleanupAC8C796B\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"SessionCleanupAC8C796B\",\"Arn\"]}","path":"ChatbotLambdaStack/Exports/Output{\"Fn::GetAtt\":[\"SessionCleanupAC8C796B\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Ref\":\"ApiSecretsED109BDA\"}":{"id":"Output{\"Ref\":\"ApiSecretsED109BDA\"}","path":"ChatbotLambdaStack/Exports/Output{\"Ref\":\"ApiSecretsED109BDA\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Ref\":\"McpServerConstructMcpServerSecretsD3E08119\"}":{"id":"Output{\"Ref\":\"McpServerConstructMcpServerSecretsD3E08119\"}","path":"ChatbotLambdaStack/Exports/Output{\"Ref\":\"McpServerConstructMcpServerSecretsD3E08119\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ChatbotLambdaStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.219.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ChatbotLambdaStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.219.0"}}}},"ChatbotApiStack":{"id":"ChatbotApiStack","path":"ChatbotApiStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.219.0"},"children":{"WebSocketApiConstruct":{"id":"WebSocketApiConstruct","path":"ChatbotApiStack/WebSocketApiConstruct","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"ChatbotWebSocketApi":{"id":"ChatbotWebSocketApi","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketApi","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnApi","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Api","aws:cdk:cloudformation:props":{"description":"WebSocket API for real-time chatbot communication","name":"chatbot-websocket-api","protocolType":"WEBSOCKET","routeSelectionExpression":"$request.body.action"}}},"$connect-Route":{"id":"$connect-Route","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$connect-Route","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketRoute","version":"2.219.0","metadata":[]},"children":{"ConnectIntegration-Permission":{"id":"ConnectIntegration-Permission","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$connect-Route/ConnectIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::ImportValue":"ChatbotLambdaStack:ExportsOutputFnGetAttWebSocketHandler47C0AA1AArn9F4E8392"},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":",{"Ref":"WebSocketApiConstructChatbotWebSocketApi78B4F282"},"/*$connect"]]}}}},"ConnectIntegration":{"id":"ConnectIntegration","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$connect-Route/ConnectIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketIntegration","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$connect-Route/ConnectIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"WebSocketApiConstructChatbotWebSocketApi78B4F282"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:",{"Ref":"AWS::Region"},":lambda:path/2015-03-31/functions/",{"Fn::ImportValue":"ChatbotLambdaStack:ExportsOutputFnGetAttWebSocketHandler47C0AA1AArn9F4E8392"},"/invocations"]]}}}}}},"Resource":{"id":"Resource","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$connect-Route/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"WebSocketApiConstructChatbotWebSocketApi78B4F282"},"authorizationType":"NONE","routeKey":"$connect","target":{"Fn::Join":["",["integrations/",{"Ref":"WebSocketApiConstructChatbotWebSocketApiconnectRouteConnectIntegrationF5C8BD8C"}]]}}}}}},"$disconnect-Route":{"id":"$disconnect-Route","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$disconnect-Route","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketRoute","version":"2.219.0","metadata":[]},"children":{"DisconnectIntegration-Permission":{"id":"DisconnectIntegration-Permission","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$disconnect-Route/DisconnectIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::ImportValue":"ChatbotLambdaStack:ExportsOutputFnGetAttWebSocketHandler47C0AA1AArn9F4E8392"},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":",{"Ref":"WebSocketApiConstructChatbotWebSocketApi78B4F282"},"/*$disconnect"]]}}}},"DisconnectIntegration":{"id":"DisconnectIntegration","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$disconnect-Route/DisconnectIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketIntegration","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$disconnect-Route/DisconnectIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"WebSocketApiConstructChatbotWebSocketApi78B4F282"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:",{"Ref":"AWS::Region"},":lambda:path/2015-03-31/functions/",{"Fn::ImportValue":"ChatbotLambdaStack:ExportsOutputFnGetAttWebSocketHandler47C0AA1AArn9F4E8392"},"/invocations"]]}}}}}},"Resource":{"id":"Resource","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$disconnect-Route/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"WebSocketApiConstructChatbotWebSocketApi78B4F282"},"authorizationType":"NONE","routeKey":"$disconnect","target":{"Fn::Join":["",["integrations/",{"Ref":"WebSocketApiConstructChatbotWebSocketApidisconnectRouteDisconnectIntegration787A7ED4"}]]}}}}}},"$default-Route":{"id":"$default-Route","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$default-Route","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketRoute","version":"2.219.0","metadata":[]},"children":{"DefaultIntegration-Permission":{"id":"DefaultIntegration-Permission","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$default-Route/DefaultIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::ImportValue":"ChatbotLambdaStack:ExportsOutputFnGetAttWebSocketHandler47C0AA1AArn9F4E8392"},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":",{"Ref":"WebSocketApiConstructChatbotWebSocketApi78B4F282"},"/*$default"]]}}}},"DefaultIntegration":{"id":"DefaultIntegration","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$default-Route/DefaultIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketIntegration","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$default-Route/DefaultIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"WebSocketApiConstructChatbotWebSocketApi78B4F282"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:",{"Ref":"AWS::Region"},":lambda:path/2015-03-31/functions/",{"Fn::ImportValue":"ChatbotLambdaStack:ExportsOutputFnGetAttWebSocketHandler47C0AA1AArn9F4E8392"},"/invocations"]]}}}}}},"Resource":{"id":"Resource","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketApi/$default-Route/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"WebSocketApiConstructChatbotWebSocketApi78B4F282"},"authorizationType":"NONE","routeKey":"$default","target":{"Fn::Join":["",["integrations/",{"Ref":"WebSocketApiConstructChatbotWebSocketApidefaultRouteDefaultIntegrationD5E8FF0D"}]]}}}}}}}},"ChatbotWebSocketStage":{"id":"ChatbotWebSocketStage","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketStage","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketStage","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ChatbotApiStack/WebSocketApiConstruct/ChatbotWebSocketStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"apiId":{"Ref":"WebSocketApiConstructChatbotWebSocketApi78B4F282"},"autoDeploy":true,"stageName":"prod"}}}}},"WebSocketApiEndpoint":{"id":"WebSocketApiEndpoint","path":"ChatbotApiStack/WebSocketApiConstruct/WebSocketApiEndpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"WebSocketApiId":{"id":"WebSocketApiId","path":"ChatbotApiStack/WebSocketApiConstruct/WebSocketApiId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}}}},"CDKMetadata":{"id":"CDKMetadata","path":"ChatbotApiStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ChatbotApiStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}},"Condition":{"id":"Condition","path":"ChatbotApiStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.219.0"}}}},"Exports":{"id":"Exports","path":"ChatbotApiStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Fn::GetAtt\":[\"WebSocketApiConstructChatbotWebSocketApi78B4F282\",\"ApiEndpoint\"]}":{"id":"Output{\"Fn::GetAtt\":[\"WebSocketApiConstructChatbotWebSocketApi78B4F282\",\"ApiEndpoint\"]}","path":"ChatbotApiStack/Exports/Output{\"Fn::GetAtt\":[\"WebSocketApiConstructChatbotWebSocketApi78B4F282\",\"ApiEndpoint\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Output{\"Ref\":\"WebSocketApiConstructChatbotWebSocketApi78B4F282\"}":{"id":"Output{\"Ref\":\"WebSocketApiConstructChatbotWebSocketApi78B4F282\"}","path":"ChatbotApiStack/Exports/Output{\"Ref\":\"WebSocketApiConstructChatbotWebSocketApi78B4F282\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ChatbotApiStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.219.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ChatbotApiStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.219.0"}}}},"ChatbotMainStack":{"id":"ChatbotMainStack","path":"ChatbotMainStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.219.0"},"children":{"WebSocketApiEndpoint":{"id":"WebSocketApiEndpoint","path":"ChatbotMainStack/WebSocketApiEndpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"WebSocketApiId":{"id":"WebSocketApiId","path":"ChatbotMainStack/WebSocketApiId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"SessionsTableName":{"id":"SessionsTableName","path":"ChatbotMainStack/SessionsTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"ConversationsTableName":{"id":"ConversationsTableName","path":"ChatbotMainStack/ConversationsTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"AnalyticsTableName":{"id":"AnalyticsTableName","path":"ChatbotMainStack/AnalyticsTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"WebSocketHandlerArn":{"id":"WebSocketHandlerArn","path":"ChatbotMainStack/WebSocketHandlerArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"McpServerArn":{"id":"McpServerArn","path":"ChatbotMainStack/McpServerArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"SessionCleanupArn":{"id":"SessionCleanupArn","path":"ChatbotMainStack/SessionCleanupArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"ApiSecretsArn":{"id":"ApiSecretsArn","path":"ChatbotMainStack/ApiSecretsArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"McpSecretsArn":{"id":"McpSecretsArn","path":"ChatbotMainStack/McpSecretsArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"DocumentsBucketName":{"id":"DocumentsBucketName","path":"ChatbotMainStack/DocumentsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"ProcessedDocumentsBucketName":{"id":"ProcessedDocumentsBucketName","path":"ChatbotMainStack/ProcessedDocumentsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"DocumentProcessorArn":{"id":"DocumentProcessorArn","path":"ChatbotMainStack/DocumentProcessorArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"DocumentUploadHandlerArn":{"id":"DocumentUploadHandlerArn","path":"ChatbotMainStack/DocumentUploadHandlerArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"ChatbotMainStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ChatbotMainStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}},"Condition":{"id":"Condition","path":"ChatbotMainStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.219.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ChatbotMainStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.219.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ChatbotMainStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.219.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}